# ================================
# AI 执行总则（Blackbox Rules）
# ================================

## 一、项目根目录强制认定规则

1. 无论当前执行环境、工作路径、终端所在目录、上级目录结构如何变化：
   - **项目唯一根目录强制认定为：**
     ```
     my_ai_popup_project/
     ```
2. AI 在执行任何操作前，必须：
   - 自动定位并锁定 `my_ai_popup_project` 作为项目根目录
   - 所有路径解析、文件扫描、子项目识别，均以该目录为起点
   - 禁止将根目录误判为其上级或同级目录

---

## 二、项目全局联动与一致性规则（强制）

1. 每次进行以下操作之一时：
   - 功能修改
   - 功能优化
   - Bug 修复
   - 参数调整
   - 逻辑重构
   - 文档补充
   - JSON / 配置更新

2. AI **必须同步分析并联动检查**：
   - 关联功能模块
   - 子项目
   - 依赖函数
   - 公共参数
   - 配置文件（如 `.json` / `.env` / `.config`）
   - 说明文档 / README / 注释
   - UI / 交互 / 弹窗 / 联动逻辑
   - API / 数据结构 / 状态管理

3. **任何修改都不得是“孤立修改”**：
   - 如果一个改动会影响其他功能 → 必须同步调整
   - 如果存在重复逻辑 → 必须统一优化
   - 如果存在联动点 → 必须全局同步更新

---

## 三、原文件优先优化原则

1. 每次修改或优化时：
   - **优先在原有文件 / 原有脚本中进行**
   - 禁止无必要地新建重复文件
   - 禁止逻辑分叉、功能分裂

2. 只有在以下情况下才允许新建文件：
   - 明确的模块拆分需求
   - 项目结构规范化需要
   - 避免代码耦合或重复

---

## 四、子项目与目录逐级识别规则

1. 当涉及子项目或模块优化时：
   - AI 必须从项目根目录开始
   - **逐级、逐层扫描并识别**
     ```
     my_ai_popup_project/
       ├─ 子项目/
       │   ├─ 子模块/
       │   │   ├─ 文件/
       │   │   │   └─ 最后一行代码
     ```

2. 识别深度要求：
   - 文件夹 → 子文件夹 → 文件 → 代码 → 最后一行
   - 不允许“只看表层、不看底层”

---

## 五、终端与执行环境识别规则

1. 每次执行终端命令前，AI 必须明确：
   - 使用的终端类型（如 bash / zsh / powershell / cmd / node / python）
   - 当前操作系统环境
   - 命令是否依赖特定 Shell 或运行时

2. 禁止以下行为：
   - 在错误终端执行命令
   - 不区分平台直接输出命令
   - 混用不兼容命令

---

## 六、错误自动修正与持续优化规则

1. 当发现以下情况时：
   - 代码错误
   - 逻辑冲突
   - 参数不一致
   - 文档与实现不匹配
   - 配置失效

2. AI 必须：
   - 自动分析错误原因
   - 给出优化与修正方案
   - 同步修复所有受影响模块
   - 保证项目整体一致性与可运行性

---

## 七、执行前分析与用户确认机制（强制）

1. 在**任何实际部署 / 执行 / 修改代码前**，AI 必须：

   ### ① 需求分析
   - 分析用户描述的真实意图
   - 识别影响范围
   - 判断是否涉及全局联动

   ### ② 复述需求
   - 用清晰、结构化语言复述理解内容
   - 明确“将要做什么”和“不做什么”

   ### ③ 任务部署建议
   - 给出执行步骤
   - 给出涉及文件与模块清单
   - 给出风险与联动点说明

2. **只有在用户明确同意后**：
   - 才允许执行实际修改、命令、部署、写入文件

---

## 八、上下文完整识别规则

1. 每次处理以下内容时：
   - 脚本
   - 配置
   - 文档
   - 代码文件

2. AI 必须：
   - 识别并理解完整上下文
   - **从第一行分析到最后一行**
   - 禁止断章取义
   - 禁止只修改局部而忽略整体

---

## 九、全局执行原则总结

- 项目根目录唯一且固定
- 修改必须全局联动
- 优化优先在原文件完成
- 子项目逐级逐层识别
- 终端与环境明确区分
- 错误自动修正
- 执行前必须分析 + 复述 + 用户确认
- 所有上下文必须完整理解

# 本规则对 AI 执行具有最高优先级
# 未遵守即视为执行失败

