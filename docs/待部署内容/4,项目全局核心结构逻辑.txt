脚本项目落实时需要重点考虑的思路与问题预防
一、验证与安全性（前后端 & 内部逻辑）

输入验证

所有外部输入（用户输入、配置文件、API参数）必须有校验机制，防止注入、非法值。

文件路径验证，避免目录遍历。

API参数验证，避免恶意构造请求。

前端/界面交互验证（如果涉及 Web 或可视化界面）

必须有基础的表单校验（必填、格式、长度）。

提交前的快速校验，减少无效请求流入后端。

后端/脚本内部逻辑验证

即使前端已经验证，后端也必须做二次验证（防御性编程）。

对关键业务操作进行权限检查（避免绕过）。

敏感信息保护

API Key / Token 不要硬编码在脚本中，应放在安全存储（环境变量、密钥管理服务）。

日志中避免明文输出密码/Token。

异常防御

对不可控的外部资源（API/数据库/文件系统）必须有超时和异常捕获。

避免因为一个输入错误导致脚本整体崩溃。

二、适配性与兼容性

运行环境差异

考虑不同操作系统（Linux / Windows / Mac）的路径差异、权限差异。

依赖的软件包、命令行工具要检测版本并兼容。

浏览器与前端兼容性（如涉及 Web 页面/交互）

脚本输出的页面要考虑主流浏览器（Chrome/Firefox/Edge）兼容。

避免使用过时或实验性 API。

API/接口版本适配

若依赖第三方 API，要提前适配版本差异。

预留 API 升级/弃用的兼容逻辑。

三、全局联动性

模块间影响

一个模块修改是否会破坏其他模块（要保持清晰的输入/输出契约）。

全局配置变更（如路径、API URL）是否会在所有模块生效。

状态一致性

不同模块写入的数据或状态需要有一致性机制。

避免“一个成功一个失败”导致整体数据不同步。

错误传播

出现错误时如何影响全局：

是否允许部分失败？

是否触发全局回滚？

四、功能联动性

依赖顺序与执行逻辑

脚本任务之间要有严格的顺序控制（先建目录 → 再写文件 → 再上传）。

必须保证依赖关系被明确定义，避免“后面的步骤依赖前面未完成的数据”。

多功能协同

文件操作、API交互、数据库更新等功能需要协同，避免数据丢失或重复执行。

幂等性：同一操作重复执行不会产生副作用（如重复写入同一数据）。

扩展功能的预留

脚本要考虑未来增加新功能时能平滑接入，不破坏已有功能。

五、接口与 API 交互

接口调用的稳定性

设置超时与重试机制，防止脚本长期阻塞。

失败时记录详细日志，便于排查。

数据格式与契约

请求与响应数据必须验证格式，防止解析错误。

遇到未知字段或格式变化时，脚本应容忍并记录，而不是直接崩溃。

认证与授权

所有 API 调用要使用安全的认证方式（Bearer Token、OAuth）。

对关键接口要确认权限范围，避免越权。

六、排序与逻辑合理性

任务顺序

按照依赖关系执行，避免“写数据前未建立数据库”。

对可并行的任务进行排序优化，提高效率。

逻辑清晰度

每个步骤都有开始、执行、结束标志，避免逻辑跳跃。

日志输出应能反映执行流程（方便调试）。

错误分支处理

明确每个逻辑分支的处理方式，避免陷入死循环。

七、配置合理性

集中管理配置

所有可变参数集中在配置文件（如 config.json / .env）。

避免在脚本中硬编码路径、IP、账号。

环境隔离

开发/测试/生产环境要有独立配置，避免误操作。

脚本要明确读取对应环境的配置文件。

动态调整

配置项应支持动态修改，不用重写脚本。

参数要有默认值和合理的边界范围（如最大并发数、超时阈值）。

八、需要额外预防的问题

数据丢失 / 覆盖风险

写文件或数据库前，应先备份或检查是否已存在。

资源占用与泄漏

文件句柄/网络连接必须关闭。

防止内存占用过大（尤其是长时间运行的脚本）。

异常中断后的恢复

脚本中断时如何恢复？

是否有检查点 / 断点续跑逻辑？

安全审计与合规性

是否有执行记录（日志/审计追踪）。

是否满足内部或外部合规（GDPR、数据加密要求）。

浏览器端安全问题（如果有前端交互）

防止 XSS / CSRF 注入。

使用 HTTPS 进行数据传输。

Cookie/Token 管理要遵循安全策略（HttpOnly、Secure）。
