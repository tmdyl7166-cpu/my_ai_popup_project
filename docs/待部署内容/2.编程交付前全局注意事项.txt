一、执行环境相关

跨平台差异

Windows / Linux / macOS 在命令、路径、权限、依赖管理方式上不同。

不同 shell（bash、zsh、fish、PowerShell）执行语法差异。

依赖工具版本差异

Node、Python、Docker、Git、数据库 CLI 工具等版本不一致可能导致构建失败。

脚本是否支持最低 / 推荐 / 最新版本的兼容性。

运行权限

是否需要 root / sudo。

普通用户执行时可能缺少写权限（/var、/etc 等目录）。

二、配置与安全性

配置管理

同一份代码需支持多环境（开发、测试、预生产、生产）。

如何避免配置硬编码，支持 .env、环境变量、外部配置中心。

敏感信息

密码、API Key、Token 等如何安全存储（Vault、Secrets Manager）。

日志中避免输出敏感信息。

密钥轮换

部署过程中若遇到过期密钥，如何快速更新并不中断流程。

三、依赖与资源

系统依赖

脚本运行前，系统是否已具备需要的软件（Git、Node、Python、DB 客户端）。

第三方服务依赖

代码仓库是否可访问（网络、VPN、防火墙）。

镜像仓库或包管理源是否有网络限制。

硬件资源

磁盘空间不足导致构建/备份失败。

内存不足导致容器或编译失败。

四、部署流程控制

顺序与依赖

数据库必须先启动，后端依赖数据库，前端依赖后端 API。

消息队列、缓存等中间件的依赖顺序。

并发与锁

多人同时触发部署可能引发冲突。

需要文件锁/分布式锁机制来保证一次只执行一个部署。

幂等性

重复执行同一命令不会导致状态异常。

比如：重复创建用户、重复迁移数据库。

五、构建与发布

代码获取

Git 分支、tag、commit 是否固定。

是否允许自动回滚到上一个版本。

依赖安装

是否使用 lock 文件保证依赖确定性。

网络不通时是否有本地缓存或镜像源。

构建产物

前端打包产物、后端可执行文件、容器镜像如何存储。

是否需要签名或校验构建产物。

六、数据库与数据安全

迁移与回滚

数据库迁移失败时如何回滚。

是否支持向后兼容迁移（避免回滚困难）。

数据备份

部署前是否执行快照或备份。

备份文件的存储位置、加密与清理机制。

大数据量风险

大规模数据迁移可能超时或锁表，需要考虑分批或在线迁移。

七、健康检查与验证

服务可用性

HTTP 接口是否返回 200。

数据库能否执行基本查询。

超时与重试

启动时间不可预测，需要合理等待和重试机制。

监控与日志

部署过程中是否采集关键日志。

部署后是否监控错误率、响应时间。

八、回滚与灾难恢复

自动回滚触发条件

健康检查失败 / 部署脚本异常退出 / 日志中出现严重错误。

回滚方案

恢复代码版本。

恢复数据库快照。

回滚失败时是否有“最后安全模式”。

灾备与冗余

是否有蓝绿部署或金丝雀发布，降低单次失败影响范围。

九、日志与审计

日志分级与存储

DEBUG、INFO、WARN、ERROR。

是否集中化存储（ELK/Prometheus）。

审计追踪

记录谁在何时触发了部署、部署了什么版本。

记录关键操作与执行结果。

十、测试与验证

预检

提前检查环境与依赖，减少中途失败。

集成测试

部署后自动执行 smoke test（关键 API、业务流程）。

灰度发布

部分流量先导入新版本，确认无异常后再全量推广。

十一、团队协作与运维

文档与培训

是否有完整的 README / 部署文档。

新人能否快速上手。

异常应急

脚本失败时是否有人工介入指引。

是否支持手动中断、手动回滚。

通知机制

部署成功/失败是否有消息通知

十二、长期维护问题

脚本可扩展性

是否容易增加新服务、新依赖。

可移植性

是否能迁移到新服务器、新环境。

更新与兼容

部署脚本本身如何升级。

新旧版本是否能共存。
