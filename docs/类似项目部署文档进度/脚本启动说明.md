# AISP è„šæœ¬å¯åŠ¨è¯´æ˜æ–‡æ¡£

> æ•´ç†æ¸…ç†æ‰€æœ‰å·²å¯ç”¨çš„è„šæœ¬ï¼Œå¯¹æ‰€æœ‰è„šæœ¬å†…å®¹è¿›è¡Œæ•´ç†ï¼Œå¹¶æä¾›åŠŸèƒ½çš„å¯åŠ¨é¡¹è¯´æ˜
> 
> æ–‡æ¡£ç‰ˆæœ¬: 2.0.0
> æœ€åæ›´æ–°: 2025-01-21

---

## ä¸€ã€è„šæœ¬åˆ†ç±»æ€»è§ˆ

| ç±»åˆ« | è„šæœ¬ | åŠŸèƒ½ | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| **ç¯å¢ƒé…ç½®** | `setup_env.sh` | å®‰è£…ä¾èµ–ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ | ğŸ”´ é«˜ |
| **ç¯å¢ƒé…ç½®** | `deploy.sh` | ä¸€é”®å®Œæ•´éƒ¨ç½²ï¼ˆæ”¯æŒDockerï¼‰ | ğŸ”´ é«˜ |
| **ç¯å¢ƒé…ç½®** | `cleanup_env.sh` | æ¸…ç†ç¯å¢ƒã€åœæ­¢è¿›ç¨‹ã€åˆ é™¤ç¼“å­˜ | ğŸ”´ é«˜ |
| **ç¯å¢ƒé…ç½®** | `setup_aisp_with_ollama.sh` | Ollamaé›†æˆå¯åŠ¨è„šæœ¬ | ğŸ”´ é«˜ |
| **æœåŠ¡å¯åŠ¨** | `start_server.sh` | å¯åŠ¨åç«¯APIæœåŠ¡å™¨ | ğŸ”´ é«˜ |
| **æœåŠ¡å¯åŠ¨** | `start_gui.sh` | å¯åŠ¨PyQt6å›¾å½¢ç•Œé¢ | ğŸŸ¡ ä¸­ |
| **æœåŠ¡å¯åŠ¨** | `start_all.sh` | ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡ | ğŸŸ¡ ä¸­ |
| **æœåŠ¡å¯åŠ¨** | `start_server.sh` | å¯åŠ¨åç«¯API | ğŸŸ¡ ä¸­ |
| **éªŒè¯æ£€æŸ¥** | `health_check.py` | ç³»ç»Ÿå¥åº·æ£€æµ‹ï¼ˆæ”¯æŒWebç•Œé¢ï¼‰ | ğŸ”µ ä½ |
| **éªŒè¯æ£€æŸ¥** | `verify_deployment.py` | éƒ¨ç½²å®Œæ•´æ€§éªŒè¯ | ğŸ”µ ä½ |
| **éªŒè¯æ£€æŸ¥** | `verify_paths.py` | è·¯å¾„é…ç½®éªŒè¯ | ğŸ”µ ä½ |
| **å·²åºŸå¼ƒ** | `monitor.py` | æ€§èƒ½ç›‘æ§ï¼ˆå·²åºŸå¼ƒï¼Œç»Ÿä¸€ä½¿ç”¨performance_monitor.pyï¼‰ | âš« åºŸå¼ƒ |

---

## äºŒã€å¯åŠ¨è·¯å¾„æ€»è§ˆ

### 2.1 Pythonæ¨¡å—è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰

æ‰€æœ‰æ¨¡å—å‡ä»¥ `/home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP` ä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼š

```
/home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ control_core/
â”‚   â”‚   â”œâ”€â”€ server.py           â† ä¸»APIæœåŠ¡å™¨å…¥å£ï¼ˆå½“å‰ä½¿ç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ state_manager.py    â† çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ pipeline_manager.py â† æµæ°´çº¿ç®¡ç†
â”‚   â”‚   â””â”€â”€ auth.py            â† è®¤è¯ç®¡ç†
â”‚   â”œâ”€â”€ api.py                 â† APIè·¯ç”±å®šä¹‰ï¼ˆæ—§ç‰ˆå…¥å£ï¼‰
â”‚   â”œâ”€â”€ unified_api.py         â† ç»Ÿä¸€APIå…¥å£ï¼ˆæ–°ç‰ˆï¼ŒåŒ…å«ä¸šåŠ¡+ç›‘æ§ï¼‰
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ performance_monitor.py  â† æ€§èƒ½ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ video_pipeline.py       â† è§†é¢‘å¤„ç†
â”‚   â”‚   â”œâ”€â”€ local_ai_interface.py   â† æœ¬åœ°AIæ¥å£
â”‚   â”‚   â”œâ”€â”€ camera_service.py       â† æ‘„åƒå¤´ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ recognition_service.py  â† å›¾ç‰‡è¯†åˆ«
â”‚   â”‚   â””â”€â”€ video_compositor.py     â† è§†é¢‘åˆæˆ
â”‚   â””â”€â”€ ai_control/
â”‚       â”œâ”€â”€ ollama_client.py    â† Ollama AIå®¢æˆ·ç«¯
â”‚       â””â”€â”€ auto_strategy.py    â† è‡ªåŠ¨ç­–ç•¥ç”Ÿæˆ
â”œâ”€â”€ gui/
â”‚   â””â”€â”€ main_window.py          â† GUIä¸»çª—å£
â”œâ”€â”€ virtual_cam/
â”‚   â””â”€â”€ virtual_camera.py       â† è™šæ‹Ÿæ‘„åƒå¤´
â””â”€â”€ obs_integration/
    â””â”€â”€ obs_controller.py       â† OBSæ§åˆ¶å™¨
```

### 2.2 å¯åŠ¨è„šæœ¬è·¯å¾„

```
/home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP/scripts/
â”œâ”€â”€ setup_env.sh           # ç¯å¢ƒé…ç½®è„šæœ¬
â”œâ”€â”€ deploy.sh              # å®Œæ•´éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ cleanup_env.sh         # ç¯å¢ƒæ¸…ç†è„šæœ¬
â”œâ”€â”€ start_server.sh        # å¯åŠ¨åç«¯API
â”œâ”€â”€ start_gui.sh           # å¯åŠ¨GUIç•Œé¢
â”œâ”€â”€ start_all.sh           # ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
â”œâ”€â”€ start_aisp_with_ollama.sh  # Ollamaé›†æˆå¯åŠ¨
â”œâ”€â”€ health_check.py        # å¥åº·æ£€æµ‹è„šæœ¬
â”œâ”€â”€ verify_deployment.py   # éƒ¨ç½²éªŒè¯
â”œâ”€â”€ verify_paths.py        # è·¯å¾„éªŒè¯
â””â”€â”€ monitor.py             # ç›‘æ§è„šæœ¬ï¼ˆå·²åºŸå¼ƒï¼‰
```

---

## ä¸‰ã€ç¯å¢ƒé…ç½®è„šæœ¬

### 1. setup_env.sh - ç¯å¢ƒé…ç½®è„šæœ¬

**ä½ç½®**: `scripts/setup_env.sh`

**åŠŸèƒ½**:
- æ£€æŸ¥Pythonç‰ˆæœ¬ï¼ˆéœ€è¦>=3.10ï¼Œæ¨è3.12ï¼‰
- åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ
- å‡çº§pip
- å®‰è£…requirements.txtä¸­çš„æ‰€æœ‰ä¾èµ–

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
bash scripts/setup_env.sh
```

**è¾“å‡º**:
- è™šæ‹Ÿç¯å¢ƒç›®å½•: `venv/`
- ä¾èµ–å®‰è£…ä½ç½®: `venv/lib/python3.x/site-packages/`

---

### 2. deploy.sh - å®Œæ•´éƒ¨ç½²è„šæœ¬

**ä½ç½®**: `scripts/deploy.sh`

**åŠŸèƒ½**:
- æ”¯æŒä¸¤ç§éƒ¨ç½²æ¨¡å¼ï¼šæœ¬åœ°è™šæ‹Ÿç¯å¢ƒ / Dockerå®¹å™¨
- æ­¥éª¤1: æ£€æŸ¥ç³»ç»Ÿè¦æ±‚ï¼ˆPythonç‰ˆæœ¬ï¼‰
- æ­¥éª¤2: åˆ›å»º/æ›´æ–°è™šæ‹Ÿç¯å¢ƒ
- æ­¥éª¤3: å®‰è£…Pythonä¾èµ–
- æ­¥éª¤4: Dockeræ¨¡å¼éƒ¨ç½²ï¼ˆå¦‚é€‰æ‹©ï¼‰
- æ­¥éª¤5: åˆå§‹åŒ–å¿…è¦ç›®å½•ï¼ˆlogsã€dataã€modelsï¼‰
- æ­¥éª¤6: å¯åŠ¨Backend APIå’Œå¥åº·æ£€æµ‹æœåŠ¡

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
bash scripts/deploy.sh

# é€‰æ‹©éƒ¨ç½²æ¨¡å¼:
# 1) æœ¬åœ°è™šæ‹Ÿç¯å¢ƒæ¨¡å¼ï¼ˆæ¨èï¼Œæ— Dockerä¾èµ–ï¼‰
# 2) Dockerå®¹å™¨æ¨¡å¼ï¼ˆéœ€è¦Docker + NVIDIAæ”¯æŒï¼‰
```

**è¾“å‡º**:
- æœåŠ¡å¯åŠ¨åè®¿é—®: http://localhost:8000
- APIæ–‡æ¡£: http://localhost:8000/docs
- æ—¥å¿—ä½ç½®: `logs/backend.log`

---

### 3. cleanup_env.sh - ç¯å¢ƒæ¸…ç†è„šæœ¬

**ä½ç½®**: `scripts/cleanup_env.sh`

**åŠŸèƒ½**:
- åœæ­¢AISPç›¸å…³è¿›ç¨‹ï¼ˆaispã€backendã€uvicornã€monitorï¼‰
- åˆ é™¤è™šæ‹Ÿç¯å¢ƒï¼ˆvenv/ï¼‰
- æ¸…ç†Pythonç¼“å­˜ï¼ˆ__pycache__ã€*.pycã€.pytest_cacheï¼‰
- æ¸…ç†æ—¥å¿—æ–‡ä»¶ï¼ˆlogs/*.logã€logs/*.jsonï¼‰
- åœæ­¢Dockerå®¹å™¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
bash scripts/cleanup_env.sh

# éœ€è¦ç”¨æˆ·ç¡®è®¤ (è¾“å…¥ y ç»§ç»­)
```

**âš ï¸ è­¦å‘Š**: æ­¤æ“ä½œä¸å¯é€†ï¼Œä¼šåˆ é™¤è™šæ‹Ÿç¯å¢ƒå’Œç¼“å­˜æ–‡ä»¶

---

### 4. start_aisp_with_ollama.sh - Ollamaé›†æˆå¯åŠ¨è„šæœ¬

**ä½ç½®**: `scripts/start_aisp_with_ollama.sh`

**åŠŸèƒ½**:
- æ”¯æŒOllamaè‡ªåŠ¨å®‰è£…
- ç«¯å£æ£€æµ‹å’Œè‡ªåŠ¨åˆ‡æ¢
- å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡è¯•
- AISPæœåŠ¡é›†æˆå¯åŠ¨

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
bash scripts/start_aisp_with_ollama.sh
```

**ç¯å¢ƒå˜é‡**:
- `OLLAMA_PORT` - Ollamaç«¯å£ï¼ˆé»˜è®¤: 11434ï¼‰
- `AISP_OLLAMA_URL` - OllamaæœåŠ¡å™¨åœ°å€
- `AISP_OLLAMA_PORT` - Ollamaç«¯å£é…ç½®

**ç«¯å£å…¼å®¹æ€§é…ç½®**:
```json
{
  "port_compatibility": {
    "enabled": true,
    "default_port": 11434,
    "fallback_ports": [11435, 11436, 11437, 11438, 11439],
    "auto_detect": true
  }
}
```

---

## å››ã€æœåŠ¡å¯åŠ¨è„šæœ¬

### 5. start_server.sh - åç«¯APIæœåŠ¡å™¨

**ä½ç½®**: `scripts/start_server.sh`

**åŠŸèƒ½**:
- æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
- å¯åŠ¨FastAPIåç«¯æœåŠ¡å™¨
- é»˜è®¤ç«¯å£: 8000

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
bash scripts/start_server.sh
```

**è®¿é—®åœ°å€**:
- APIæ–‡æ¡£: http://localhost:8000/docs
- å¥åº·æ£€æŸ¥: http://localhost:8000/health
- çŠ¶æ€ç›‘æ§: http://localhost:8000/api/status

**å¯åŠ¨ä»£ç åˆ†æ** (`backend/control_core/server.py`):
```python
from fastapi import FastAPI, HTTPException, BackgroundTasks, Depends
from pydantic import BaseModel
from typing import Dict, Any, Optional, List
import uvicorn
import time
import threading
from contextlib import asynccontextmanager

# åˆå§‹åŒ–ç»„ä»¶
state_manager = StateManager()
resource_guard = ResourceGuard()
validator = ConfigurationValidator()
pipeline_manager = PipelineManager()

# åˆå§‹åŒ–AIç»„ä»¶
ollama_client = OllamaClient()
auto_strategy = AutoStrategy(ollama_client)
memory_store = MemoryDB()

# åˆå§‹åŒ–ç”¨æˆ·ä¼šè¯ç®¡ç†å™¨
session_manager = create_user_session_manager()
set_session_manager(session_manager)

@asynccontextmanager
async def lifespan(app: FastAPI):
    """åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†"""
    # å¯åŠ¨æ—¶
    state_manager.transition_to(SystemState.INIT)
    state_manager.transition_to(SystemState.IDLE)
    print("AISP Control Core å·²å¯åŠ¨")
    yield
    # å…³é—­æ—¶
    pipeline_manager.stop_pipeline()
    print("AISP Control Core å·²å…³é—­")

app = FastAPI(
    title="AISP Control Core",
    version="1.0.0",
    lifespan=lifespan
)

if __name__ == "__main__":
    uvicorn.run(
        app,
        host="0.0.0.0",
        port=8000,
        log_level="info"
    )
```

**å¯åŠ¨å‚æ•°**:
- Host: `0.0.0.0` (ç›‘å¬æ‰€æœ‰ç½‘å¡)
- Port: `8000`
- Log Level: `info`

---

### 6. start_gui.sh - GUIå›¾å½¢ç•Œé¢

**ä½ç½®**: `scripts/start_gui.sh`

**åŠŸèƒ½**:
- æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
- å¯åŠ¨PyQt6å›¾å½¢ç•Œé¢
- è®¾ç½®PYTHONPATH

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
bash scripts/start_gui.sh
```

**è¦æ±‚**: å¿…é¡»æœ‰å›¾å½¢ç•Œé¢ç¯å¢ƒï¼ˆDISPLAYå·²è®¾ç½®ï¼‰

**å¯åŠ¨ä»£ç åˆ†æ** (`gui/main_window.py`):
```python
import sys
from PyQt6.QtWidgets import QApplication
from gui.main_window import MainWindow

def main():
    """GUIå¯åŠ¨å…¥å£"""
    app = QApplication(sys.argv)
    window = MainWindow()
    window.show()
    sys.exit(app.exec())

if __name__ == "__main__":
    main()
```

---

### 7. start_all.sh - ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡

**ä½ç½®**: `scripts/start_all.sh`

**åŠŸèƒ½**:
- æ£€æŸ¥ä¾èµ–ï¼ˆè‡ªåŠ¨å®‰è£…å¦‚æœç¼ºå¤±ï¼‰
- å¯åŠ¨åç«¯APIæœåŠ¡
- å¯åŠ¨GUIç•Œé¢
- æ˜¾ç¤ºè®¿é—®åœ°å€å’Œè¿›ç¨‹ä¿¡æ¯

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
bash scripts/start_all.sh
```

**è¾“å‡º**:
- æ˜¾ç¤ºåç«¯APIå’ŒGUIçš„PID
- åœæ­¢å‘½ä»¤: `kill $API_PID $GUI_PID`

---

## äº”ã€éªŒè¯æ£€æŸ¥è„šæœ¬

### 8. health_check.py - ç³»ç»Ÿå¥åº·æ£€æµ‹

**ä½ç½®**: `scripts/health_check.py`

**åŠŸèƒ½**:
- æ£€æŸ¥ä¾èµ–å±‚ï¼ˆPythonåŒ…ç‰ˆæœ¬ï¼‰
- æ£€æŸ¥ç³»ç»Ÿå±‚ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ã€GPUï¼‰
- æ£€æŸ¥è¿›ç¨‹å±‚ï¼ˆæœåŠ¡ç«¯å£çŠ¶æ€ï¼‰
- æ£€æŸ¥ä¸šåŠ¡å±‚ï¼ˆAPIç«¯ç‚¹ã€å¼•æ“å¯ç”¨æ€§ï¼‰
- æ£€æŸ¥è¾“å‡ºå±‚ï¼ˆè™šæ‹Ÿæ‘„åƒå¤´ã€OBSé›†æˆï¼‰
- æ”¯æŒä¼˜é›…é™çº§ï¼ˆç¼ºå°‘ä¾èµ–æ—¶ä»èƒ½è¿è¡ŒåŸºç¡€åŠŸèƒ½ï¼‰

**å¯åŠ¨æ¨¡å¼**:

| æ¨¡å¼ | å‘½ä»¤ | è¯´æ˜ |
|------|------|------|
| åŸºç¡€æ£€æµ‹ | `python3 scripts/health_check.py` | æ§åˆ¶å°è¾“å‡ºæ£€æµ‹ç»“æœ |
| Webç•Œé¢ | `python3 scripts/health_check.py --web --port 8080` | å¯åŠ¨Webä»ªè¡¨ç›˜ï¼Œè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ |
| å®æ—¶ç›‘æ§ | `python3 scripts/health_check.py --monitor --interval 30` | å¾ªç¯æ£€æµ‹ï¼ŒCtrl+Cé€€å‡º |

**ä½¿ç”¨æ–¹æ³•**:
```bash
# åŸºç¡€å¥åº·æ£€æŸ¥
python3 scripts/health_check.py

# å¯åŠ¨Webç•Œé¢ï¼ˆè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼‰
python3 scripts/health_check.py --web --port 8080

# å®æ—¶ç›‘æ§æ¨¡å¼ï¼ˆæ¯30ç§’åˆ·æ–°ï¼‰
python3 scripts/health_check.py --monitor --interval 30
```

**è¾“å‡º**:
- æ§åˆ¶å°: è¯¦ç»†çš„æ£€æŸ¥æŠ¥å‘Š
- Webç•Œé¢: http://localhost:8080
- JSONç»“æœ: `logs/health_check_latest.json`

---

### 9. verify_deployment.py - éƒ¨ç½²éªŒè¯è„šæœ¬

**ä½ç½®**: `scripts/verify_deployment.py`

**åŠŸèƒ½**:
- æ£€æŸ¥æ ¸å¿ƒæ¨¡å—å¯¼å…¥ï¼ˆAI Controlã€AR Engineã€Control Coreï¼‰
- æ£€æŸ¥ä¾èµ–åŒ…å®‰è£…çŠ¶æ€
- æ£€æŸ¥ç¬¬ä¸‰æ–¹å¼•æ“æ–‡ä»¶
- æ£€æŸ¥é…ç½®æ–‡ä»¶å®Œæ•´æ€§
- æ£€æŸ¥AIæ§åˆ¶æ¨¡å—åŠŸèƒ½
- æ£€æŸ¥ARå¼•æ“æ¨¡å—åŠŸèƒ½
- æ£€æŸ¥æ§åˆ¶æ ¸å¿ƒæ¨¡å—åŠŸèƒ½
- æ£€æŸ¥è¾“å‡ºæ¨¡å—åŠŸèƒ½

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
python3 scripts/verify_deployment.py
```

---

### 10. verify_paths.py - è·¯å¾„éªŒè¯è„šæœ¬

**ä½ç½®**: `scripts/verify_paths.py`

**åŠŸèƒ½**:
- éªŒè¯æ ¸å¿ƒç›®å½•æ˜¯å¦å­˜åœ¨
- éªŒè¯å…³é”®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- æ£€æŸ¥è„šæœ¬è¯­æ³•
- éªŒè¯å¼•æ“ç›®å½•
- éªŒè¯é…ç½®æ–‡ä»¶

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP
python3 scripts/verify_paths.py
```

---

### 11. monitor.py - å·²åºŸå¼ƒçš„ç›‘æ§è„šæœ¬

**ä½ç½®**: `scripts/monitor.py`

**âš ï¸ çŠ¶æ€**: å·²åºŸå¼ƒï¼Œä¸å†ç»´æŠ¤

**åºŸå¼ƒåŸå› **: åŠŸèƒ½é‡å¤ï¼Œç»Ÿä¸€ä½¿ç”¨ `backend/services/performance_monitor.py`

**æ›¿ä»£æ–¹æ¡ˆ**:
```python
from backend.services.performance_monitor import (
    PerformanceMonitor, 
    create_performance_monitor
)

# ä½¿ç”¨æ–°çš„æ€§èƒ½ç›‘æ§æ¨¡å—
monitor = create_performance_monitor(sample_interval=1.0)
metrics = monitor.get_current_metrics()
```

---

## å…­ã€Dockeréƒ¨ç½²æ–¹å¼

### Docker Compose é…ç½®

**ä½ç½®**: `containers/docker-compose.yml`

**ä½¿ç”¨æ–¹æ³•**:
```bash
# ä½¿ç”¨Docker Composeå¯åŠ¨æ‰€æœ‰æœåŠ¡
cd /home/vboxuser/æ¡Œé¢/BX/AIè§„åˆ™/AISP/containers
docker-compose up -d
```

**æœåŠ¡é…ç½®**:

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| aisp-backend | 8000 | ä¸»åº”ç”¨æœåŠ¡ |
| aisp-web | 8080 | Webç›‘æ§ç•Œé¢ |
| ollama | 11434 | æœ¬åœ°AIæœåŠ¡ |

**ç¯å¢ƒå˜é‡**:
- `CUDA_VISIBLE_DEVICES` - GPUè®¾å¤‡
- `OLLAMA_HOST` - OllamaæœåŠ¡åœ°å€

---

## ä¸ƒã€å¯åŠ¨é¡ºåºæŒ‡å—

### æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨å¯åŠ¨ï¼ˆæ¨èç”¨äºå¼€å‘è°ƒè¯•ï¼‰

```bash
# 1. é…ç½®ç¯å¢ƒï¼ˆé¦–æ¬¡æˆ–ä¾èµ–å˜æ›´æ—¶ï¼‰
bash scripts/setup_env.sh

# 2. å¯åŠ¨åç«¯API
bash scripts/start_server.sh

# 3. å¯åŠ¨GUIï¼ˆå¯é€‰ï¼Œéœ€è¦å›¾å½¢ç•Œé¢ï¼‰
bash scripts/start_gui.sh

# 4. è¿è¡Œå¥åº·æ£€æŸ¥ï¼ˆéªŒè¯æœåŠ¡çŠ¶æ€ï¼‰
python3 scripts/health_check.py --web --port 8080
```

### æ–¹å¼äºŒï¼šä¸€é”®å¯åŠ¨ï¼ˆæ¨èç”¨äºå¿«é€Ÿå¯åŠ¨ï¼‰

```bash
# ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
bash scripts/start_all.sh
```

### æ–¹å¼ä¸‰ï¼šOllamaé›†æˆå¯åŠ¨

```bash
# å¯åŠ¨Ollama + AISPå®Œæ•´æœåŠ¡
bash scripts/start_aisp_with_ollama.sh

# å•ç‹¬å¯åŠ¨Ollama
ollama serve

# è¿è¡Œæ¨¡å‹
ollama run qwen3-coder:480b-cloud
```

### æ–¹å¼å››ï¼šå®Œæ•´éƒ¨ç½²ï¼ˆç”¨äºå…¨æ–°éƒ¨ç½²ï¼‰

```bash
# 1. æ¸…ç†ç°æœ‰ç¯å¢ƒï¼ˆå¦‚æœ‰ï¼‰
bash scripts/cleanup_env.sh

# 2. å®Œæ•´éƒ¨ç½²ï¼ˆåŒ…å«ç¯å¢ƒé…ç½®å’ŒæœåŠ¡å¯åŠ¨ï¼‰
bash scripts/deploy.sh
```

---

## å…«ã€è®¿é—®åœ°å€ä¸ç«¯å£

### ç«¯å£æ˜ å°„

| æœåŠ¡ | ç«¯å£ | åè®® | è®¿é—®åœ°å€ |
|------|------|------|---------|
| åç«¯API | 8000 | HTTP | http://localhost:8000 |
| APIæ–‡æ¡£ | 8000 | HTTP | http://localhost:8000/docs |
| å¥åº·æ£€æŸ¥ | 8000 | HTTP | http://localhost:8000/health |
| Webå¥åº·æ£€æµ‹ | 8080 | HTTP | http://localhost:8080 |
| Ollama AI | 11434 | HTTP | http://localhost:11434 |

---

## ä¹ã€å¸¸è§é—®é¢˜

### Q1: å¯åŠ¨å¤±è´¥ï¼Œæç¤º "ModuleNotFoundError"

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡æ–°é…ç½®ç¯å¢ƒ
bash scripts/setup_env.sh
```

### Q2: ç«¯å£å·²è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :8000

# æˆ–åœæ­¢æ‰€æœ‰AISPè¿›ç¨‹
bash scripts/cleanup_env.sh
```

### Q3: GUIæ— æ³•å¯åŠ¨ï¼ˆæ— DISPLAYï¼‰

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä»…å¯åŠ¨åç«¯API
bash scripts/start_server.sh

# ä½¿ç”¨Webç•Œé¢æ›¿ä»£
python3 scripts/health_check.py --web --port 8080
```

### Q4: Dockeræ¨¡å¼éƒ¨ç½²å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨æœ¬åœ°è™šæ‹Ÿç¯å¢ƒæ¨¡å¼
bash scripts/deploy.sh
# é€‰æ‹© 1) æœ¬åœ°è™šæ‹Ÿç¯å¢ƒæ¨¡å¼
```

### Q5: å¥åº·æ£€æŸ¥éƒ¨åˆ†é¡¹ç›®å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
python3 scripts/health_check.py

# æ£€æŸ¥ç‰¹å®šæ¨¡å—
python3 scripts/verify_deployment.py
```

---

## åã€éªŒè¯å‘½ä»¤é€ŸæŸ¥è¡¨

```bash
# è¯­æ³•éªŒè¯
python3 -m py_compile scripts/health_check.py && echo "âœ“ è¯­æ³•æ­£ç¡®"

# é…ç½®åŠ è½½éªŒè¯
python3 -c "from config.config_loader import get_config_loader; print('âœ“ é…ç½®åŠ è½½å™¨æ­£å¸¸')"

# APIå¯¼å…¥éªŒè¯
python3 -c "from backend.api import app; print('âœ“ APIå¯¼å…¥æˆåŠŸ')"

# ç»Ÿä¸€APIå¯¼å…¥éªŒè¯
python3 -c "from backend.unified_api import app; print('âœ“ ç»Ÿä¸€APIå¯¼å…¥æˆåŠŸ')"

# è·¯å¾„éªŒè¯
python3 scripts/verify_paths.py

# éƒ¨ç½²éªŒè¯
python3 scripts/verify_deployment.py

# å¥åº·æ£€æŸ¥ï¼ˆæ§åˆ¶å°ï¼‰
python3 scripts/health_check.py

# å¥åº·æ£€æŸ¥ï¼ˆWebç•Œé¢ï¼‰
python3 scripts/health_check.py --web --port 8080

# å¥åº·æ£€æŸ¥ï¼ˆå®æ—¶ç›‘æ§ï¼‰
python3 scripts/health_check.py --monitor --interval 30
```

---

## åä¸€ã€è„šæœ¬ä¾èµ–å…³ç³»å›¾

```
setup_env.sh
    â†“
    â”œâ”€â”€ venv/ (è™šæ‹Ÿç¯å¢ƒ)
    â””â”€â”€ requirements.txt (ä¾èµ–åŒ…)
            â”‚
            â†“
start_server.sh â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚
    â”œâ”€â”€ backend.api        â†â”€â”
    â”œâ”€â”€ backend.unified_apiâ”‚  â”‚ (æ¨èä½¿ç”¨)
    â”œâ”€â”€ control_core.serverâ”‚  â”‚
    â””â”€â”€ ...                â”‚  â”‚
                          â”‚  â”‚
start_gui.sh â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚                     â”‚  â”‚
    â”œâ”€â”€ gui.main_window   â”‚  â”‚
    â””â”€â”€ PyQt6             â”‚  â”‚
                          â”‚  â”‚
start_all.sh â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”¤
    â”‚                          â”‚
    â”œâ”€â”€ start_server.sh â”€â”€â”€â”€â”€â”€â”€â”¤
    â””â”€â”€ start_gui.sh â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â†“
start_aisp_with_ollama.sh â”€â”€â”€â”€â”€â”€â”¤
    â”œâ”€â”€ Ollamaå¯åŠ¨              â”‚
    â””â”€â”€ AISPå¯åŠ¨               â”‚
                                â†“
health_check.py â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”œâ”€â”€ APIç«¯ç‚¹æ£€æŸ¥             â”‚
    â”œâ”€â”€ ç³»ç»Ÿèµ„æºæ£€æŸ¥            â”‚  verify_*.py
    â””â”€â”€ å¼•æ“çŠ¶æ€æ£€æŸ¥            â”‚
                                â†“
verify_deployment.py â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”œâ”€â”€ æ¨¡å—å¯¼å…¥éªŒè¯            â”‚
    â””â”€â”€ åŠŸèƒ½å®Œæ•´æ€§éªŒè¯          â”‚
                                â†“
verify_paths.py â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”œâ”€â”€ ç›®å½•ç»“æ„éªŒè¯            â”‚
    â””â”€â”€ è·¯å¾„é…ç½®éªŒè¯            â”‚
```

---

*æ–‡æ¡£ç‰ˆæœ¬: 2.0.0*
*æœ€åæ›´æ–°: 2025-01-21*

