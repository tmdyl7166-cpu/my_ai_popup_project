# AISP é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„æ¦‚è§ˆ

```
AISP/
â”œâ”€â”€ ğŸ¨ gui/                          # GUIç”¨æˆ·ç•Œé¢å±‚
â”‚   â”œâ”€â”€ main_window.py              # ä¸»çª—å£
â”‚   â”œâ”€â”€ hot_window_manager.py       # çƒ­çª—å£ç®¡ç†
â”‚   â”œâ”€â”€ api_config.py               # APIé…ç½®
â”‚   â”œâ”€â”€ dialogs/                    # å¯¹è¯æ¡†
â”‚   â”‚   â”œâ”€â”€ ar_config_dialog.py     # ARé…ç½®å¯¹è¯æ¡†
â”‚   â”‚   â””â”€â”€ TODO_IMPLEMENTATION.md
â”‚   â”œâ”€â”€ services/                   # GUIæœåŠ¡
â”‚   â”‚   â””â”€â”€ api_service.py          # APIæœåŠ¡å°è£…
â”‚   â””â”€â”€ widgets/                    # UIç»„ä»¶
â”‚       â”œâ”€â”€ ar_engine.py            # ARå¼•æ“ç»„ä»¶
â”‚       â”œâ”€â”€ live_streaming.py       # ç›´æ’­ç»„ä»¶
â”‚       â”œâ”€â”€ service_status_widget.py# æœåŠ¡çŠ¶æ€ç»„ä»¶
â”‚       â”œâ”€â”€ system_tray.py          # ç³»ç»Ÿæ‰˜ç›˜
â”‚       â””â”€â”€ web_embed_widget.py     # WebåµŒå…¥ç»„ä»¶
â”‚
â”œâ”€â”€ ğŸ”Œ backend/                     # åç«¯æœåŠ¡å±‚
â”‚   â”œâ”€â”€ api.py                      # FastAPIå…¥å£
â”‚   â”œâ”€â”€ unified_api.py              # ç»Ÿä¸€API
â”‚   â”œâ”€â”€ models.py                   # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ path_utils.py               # è·¯å¾„å·¥å…·
â”‚   â”œâ”€â”€ ai_control/                 # AIæ§åˆ¶å±‚
â”‚   â”‚   â”œâ”€â”€ auto_strategy.py        # è‡ªåŠ¨ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ ollama_client.py        # Ollamaå®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ memory_db.py            # å†…å­˜æ•°æ®åº“
â”‚   â”œâ”€â”€ ar_engine/                  # ARå¼•æ“å±‚
â”‚   â”‚   â”œâ”€â”€ frame_pipeline.py       # å¸§å¤„ç†ç®¡é“
â”‚   â”‚   â”œâ”€â”€ adapters/               # é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ tracker/                # è¿½è¸ªå™¨
â”‚   â”‚   â”œâ”€â”€ Deep-Live-Cam/          # Deep Live Camå¼•æ“
â”‚   â”‚   â”œâ”€â”€ facefusion/             # FaceFusionå¼•æ“
â”‚   â”‚   â””â”€â”€ iRoopDeepFaceCam/       # iRoopå¼•æ“
â”‚   â”œâ”€â”€ control_core/               # æ§åˆ¶æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ server.py               # æœåŠ¡ç«¯
â”‚   â”‚   â”œâ”€â”€ state_manager.py        # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ pipeline_manager.py     # ç®¡é“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ auth.py                 # è®¤è¯æˆæƒ
â”‚   â”‚   â”œâ”€â”€ monitor.py              # ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ resource_guard.py       # èµ„æºä¿æŠ¤
â”‚   â”‚   â”œâ”€â”€ instruction_parser.py   # æŒ‡ä»¤è§£æ
â”‚   â”‚   â”œâ”€â”€ module_router.py        # æ¨¡å—è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ user_session.py         # ç”¨æˆ·ä¼šè¯
â”‚   â”‚   â””â”€â”€ validator.py            # éªŒè¯å™¨
â”‚   â”œâ”€â”€ services/                   # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ video_pipeline.py       # è§†é¢‘ç®¡é“
â”‚   â”‚   â”œâ”€â”€ face_detection.py       # äººè„¸æ£€æµ‹
â”‚   â”‚   â”œâ”€â”€ face_recognition.py     # äººè„¸è¯†åˆ«
â”‚   â”‚   â”œâ”€â”€ face_swap.py            # äººè„¸æ›¿æ¢
â”‚   â”‚   â”œâ”€â”€ camera_service.py       # æ‘„åƒå¤´æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ video_compositor.py     # è§†é¢‘åˆæˆ
â”‚   â”‚   â”œâ”€â”€ task_scheduler.py       # ä»»åŠ¡è°ƒåº¦
â”‚   â”‚   â”œâ”€â”€ task_executor.py        # ä»»åŠ¡æ‰§è¡Œ
â”‚   â”‚   â”œâ”€â”€ performance_monitor.py  # æ€§èƒ½ç›‘æ§
â”‚   â”‚   â””â”€â”€ local_ai_interface.py   # æœ¬åœ°AIæ¥å£
â”‚   â”œâ”€â”€ database/                   # æ•°æ®åº“
â”‚   â”‚   â””â”€â”€ db.py
â”‚   â””â”€â”€ utils/                      # å·¥å…·ç±»
â”‚       â””â”€â”€ image_utils.py          # å›¾åƒå·¥å…·
â”‚
â”œâ”€â”€ âš™ï¸ engines/                     # å¼•æ“åŸºç±»
â”‚   â””â”€â”€ engine_base.py              # å¼•æ“åŸºç±»
â”‚
â”œâ”€â”€ ğŸ“¹ virtual_cam/                 # è™šæ‹Ÿæ‘„åƒå¤´
â”‚   â””â”€â”€ virtual_camera.py           # è™šæ‹Ÿæ‘„åƒå¤´å®ç°
â”‚
â”œâ”€â”€ ğŸ“º obs_integration/             # OBSé›†æˆ
â”‚   â””â”€â”€ obs_controller.py           # OBSæ§åˆ¶å™¨
â”‚
â”œâ”€â”€ ğŸŒ web/                         # Webç›‘æ§å±‚
â”‚   â”œâ”€â”€ web_api.py                  # Web APIæœåŠ¡
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â””â”€â”€ index.html              # ä¸»é¡µé¢æ¨¡æ¿
â”‚   â””â”€â”€ static/                     # é™æ€èµ„æº
â”‚       â”œâ”€â”€ css/                    # æ ·å¼æ–‡ä»¶
â”‚       â”œâ”€â”€ js/                     # JavaScript
â”‚       â”‚   â”œâ”€â”€ app.js              # ä¸»åº”ç”¨
â”‚       â”‚   â”œâ”€â”€ api.js              # APIæ¨¡å—
â”‚       â”‚   â”œâ”€â”€ charts.js           # å›¾è¡¨æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ components.js       # ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ config.js           # é…ç½®
â”‚       â”‚   â”œâ”€â”€ store.js            # çŠ¶æ€ç®¡ç†
â”‚       â”‚   â””â”€â”€ utils.js            # å·¥å…·
â”‚       â””â”€â”€ lib/                    # ç¬¬ä¸‰æ–¹åº“
â”‚
â”œâ”€â”€ âš™ï¸ config/                      # é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ config_loader.py            # é…ç½®åŠ è½½
â”‚   â”œâ”€â”€ logging_config.py           # æ—¥å¿—é…ç½®
â”‚   â”œâ”€â”€ auto_rule_checker.py        # è§„åˆ™æ£€æŸ¥
â”‚   â”œâ”€â”€ run_config.example.json     # é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ é¡¹ç›®æŒ‡å‘å‚è€ƒ.md
â”‚   â”œâ”€â”€ TODO_CONFIG_CLEANUP.md
â”‚   â”œâ”€â”€ CONFIG_CHECK_REPORT.md
â”‚   â”œâ”€â”€ CONFIG_INDEX.md
â”‚   â”œâ”€â”€ docs_sync_engine.py
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ docs_sync_state.json    # åŒæ­¥çŠ¶æ€
â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”œâ”€â”€ capability_map.json     # èƒ½åŠ›æ˜ å°„
â”‚   â”‚   â””â”€â”€ model_config.json       # æ¨¡å‹é…ç½®
â”‚   â””â”€â”€ tasks/
â”‚       â”œâ”€â”€ task_queue.json         # ä»»åŠ¡é˜Ÿåˆ—
â”‚       â”œâ”€â”€ completed_tasks.json    # å·²å®Œæˆä»»åŠ¡
â”‚       â””â”€â”€ task_schema.json        # ä»»åŠ¡Schema
â”‚
â”œâ”€â”€ ğŸ³ containers/                   # Dockerå®¹å™¨é…ç½®
â”‚   â”œâ”€â”€ Dockerfile                  # Dockeré•œåƒ
â”‚   â”œâ”€â”€ docker-compose.yml          # ç¼–æ’é…ç½®
â”‚   â”œâ”€â”€ start_aisp.sh               # å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ TODO.md
â”‚   â”œâ”€â”€ logs/                       # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ scripts/                    # è„šæœ¬ç›®å½•
â”‚   â””â”€â”€ config/                     # å®¹å™¨é…ç½®
â”‚
â”œâ”€â”€ ğŸ“œ scripts/                     # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ start_all.sh                # å¯åŠ¨æ‰€æœ‰æœåŠ¡
â”‚   â”œâ”€â”€ start_server.sh             # å¯åŠ¨åç«¯
â”‚   â”œâ”€â”€ start_gui.sh                # å¯åŠ¨GUI
â”‚   â”œâ”€â”€ start_hot_window.sh         # å¯åŠ¨çƒ­çª—å£
â”‚   â”œâ”€â”€ start_aisp_with_ollama.sh   # å¸¦Ollamaå¯åŠ¨
â”‚   â”œâ”€â”€ setup_env.sh                # ç¯å¢ƒè®¾ç½®
â”‚   â”œâ”€â”€ deploy.sh                   # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ deploy_config.sh            # é…ç½®éƒ¨ç½²
â”‚   â”œâ”€â”€ backup.sh                   # å¤‡ä»½è„šæœ¬
â”‚   â”œâ”€â”€ health_check.py             # å¥åº·æ£€æŸ¥
â”‚   â”œâ”€â”€ resource_alert.py           # èµ„æºå‘Šè­¦
â”‚   â”œâ”€â”€ disk_monitor.py             # ç£ç›˜ç›‘æ§
â”‚   â”œâ”€â”€ monitor.py                  # ç›‘æ§è„šæœ¬
â”‚   â”œâ”€â”€ cleanup_env.sh              # ç¯å¢ƒæ¸…ç†
â”‚   â”œâ”€â”€ validate_configs.py         # é…ç½®éªŒè¯
â”‚   â”œâ”€â”€ verify_paths.py             # è·¯å¾„éªŒè¯
â”‚   â”œâ”€â”€ verify_deployment.py        # éƒ¨ç½²éªŒè¯
â”‚   â”œâ”€â”€ emergency_recovery.sh       # ç´§æ€¥æ¢å¤
â”‚   â”œâ”€â”€ log_rotate.sh               # æ—¥å¿—è½®è½¬
â”‚   â”œâ”€â”€ path_config.py              # è·¯å¾„é…ç½®
â”‚   â”œâ”€â”€ exceptions.py               # å¼‚å¸¸å®šä¹‰
â”‚   â”œâ”€â”€ logging_utils.py            # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ main.py                     # ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ api_opt_.sh                 # APIä¼˜åŒ–
â”‚   â”œâ”€â”€ daemon_guard.py             # å®ˆæŠ¤è¿›ç¨‹
â”‚   â”œâ”€â”€ auto                        # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ system_diagnostic           # ç³»ç»Ÿè¯Šæ–­
â”‚   â”œâ”€â”€ log_analyzer.py             # æ—¥å¿—åˆ†æ
â”‚   â””â”€â”€ performance_report.py       # æ€§èƒ½æŠ¥å‘Š
â”‚
â”œâ”€â”€ ğŸ“ data/                        # æ•°æ®ç›®å½•
â”‚   â””â”€â”€ last_check_state.json       # æœ€åæ£€æŸ¥çŠ¶æ€
â”‚
â”œâ”€â”€ ğŸ“ logs/                        # æ—¥å¿—ç›®å½•
â”‚
â”œâ”€â”€ ğŸ“š docs/                        # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ README.md                   # æ–‡æ¡£ç´¢å¼•
â”‚   â”œâ”€â”€ é¡¹ç›®ç»“æ„è¯´æ˜.md              # æœ¬æ–‡æ¡£
â”‚   â”œâ”€â”€ æ•´ä½“é¡¹ç›®é€»è¾‘.md              # é¡¹ç›®é€»è¾‘
â”‚   â”œâ”€â”€ æ¨¡å—ä¾èµ–å…³ç³».md              # æ¨¡å—ä¾èµ–
â”‚   â”œâ”€â”€ ç»Ÿä¸€æ¥å£.md                  # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ BACKEND_MODULES.md          # åç«¯æ¨¡å—
â”‚   â”œâ”€â”€ GUI_MODULES.md              # GUIæ¨¡å—
â”‚   â”œâ”€â”€ è„šæœ¬å¯åŠ¨è¯´æ˜.md              # å¯åŠ¨è¯´æ˜
â”‚   â”œâ”€â”€ é¡¹ç›®éƒ¨ç½²æŒ‡å—.md              # éƒ¨ç½²æŒ‡å—
â”‚   â”œâ”€â”€ å¥åº·æ£€æµ‹è¯´æ˜.md              # å¥åº·æ£€æŸ¥
â”‚   â”œâ”€â”€ TASKS_INDEX.md              # ä»»åŠ¡ç´¢å¼•
â”‚   â””â”€â”€ CONSOLIDATED_OPTIMIZATION_REPORT.md  # ä¼˜åŒ–æŠ¥å‘Š
â”‚
â”œâ”€â”€ ğŸ“„ æ ¹ç›®å½•é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ .blackboxrules              # AIè§„åˆ™
â”‚   â”œâ”€â”€ .gitignore                  # Gitå¿½ç•¥
â”‚   â”œâ”€â”€ AI_RULES.json               # AIè§„åˆ™
â”‚   â”œâ”€â”€ AI_PATH_CONTEXT.json        # è·¯å¾„ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ AI_CLEANUP_POLICY.json      # æ¸…ç†ç­–ç•¥
â”‚   â”œâ”€â”€ AI3.json                    # AIé…ç½®
â”‚   â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–
â”‚   â”œâ”€â”€ run_gui.py                  # GUIå¯åŠ¨
â”‚   â”œâ”€â”€ task_queue.json             # ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”œâ”€â”€ TODO.md                     # å¾…åŠ
â”‚   â””â”€â”€ README.md                   # é¡¹ç›®è‡ªè¿°
â”‚
â””â”€â”€ ğŸ“¦ ollama-models/                # Ollamaæ¨¡å‹ç›®å½•
```

---

## ğŸ—ï¸ æ¶æ„åˆ†å±‚è¯´æ˜

### 1. GUIå±‚ (Presentation Layer)
**èŒè´£**: ç”¨æˆ·ç•Œé¢äº¤äº’
- ä½¿ç”¨PyQt6æ„å»ºç°ä»£åŒ–ç•Œé¢
- æ”¯æŒç³»ç»Ÿæ‰˜ç›˜å¸¸é©»
- æ”¯æŒWebå†…å®¹åµŒå…¥
- çƒ­çª—å£ç®¡ç†

### 2. åç«¯APIå±‚ (Application Layer)
**èŒè´£**: ä¸šåŠ¡é€»è¾‘å¤„ç†
- FastAPIé«˜æ€§èƒ½Webæ¡†æ¶
- ç»Ÿä¸€APIå…¥å£
- å¼‚æ­¥è¯·æ±‚å¤„ç†
- å®Œå–„çš„é”™è¯¯å¤„ç†

### 3. AIæ§åˆ¶å±‚ (AI Layer)
**èŒè´£**: æ™ºèƒ½å†³ç­–å’Œæ§åˆ¶
- æœ¬åœ°AIæ¨¡å‹é›†æˆ
- è‡ªåŠ¨ç­–ç•¥ç”Ÿæˆ
- Ollama LLMæ”¯æŒ
- å†…å­˜æ•°æ®åº“ç¼“å­˜

### 4. ARå¼•æ“å±‚ (Engine Layer)
**èŒè´£**: æ ¸å¿ƒç®—æ³•å®ç°
- å¤šç§ARå¼•æ“æ”¯æŒ
- å¸§å¤„ç†ç®¡é“
- äººè„¸æ£€æµ‹/è¯†åˆ«/æ›¿æ¢
- è§†é¢‘å®æ—¶å¤„ç†

### 5. è¾“å‡ºå±‚ (Output Layer)
**èŒè´£**: ç»“æœè¾“å‡º
- è™šæ‹Ÿæ‘„åƒå¤´è¾“å‡º
- OBSç›´æ’­é›†æˆ
- æ–‡ä»¶å¯¼å‡º
- å®æ—¶æµæ¨é€

### 6. ç›‘æ§å±‚ (Monitoring Layer)
**èŒè´£**: ç³»ç»Ÿç›‘æ§å’Œè¿ç»´
- Webå®æ—¶ç›‘æ§
- å¥åº·æ£€æŸ¥
- æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- å‘Šè­¦é€šçŸ¥

---

## ğŸ“Š æ¨¡å—å…³ç³»

```
ç”¨æˆ·æ“ä½œ (GUI/Web)
    â†“
åç«¯API (FastAPI)
    â”œâ”€â†’ è®¤è¯æ¨¡å— (auth.py)
    â”œâ”€â†’ çŠ¶æ€ç®¡ç† (state_manager.py)
    â”œâ”€â†’ ä»»åŠ¡è°ƒåº¦ (task_scheduler.py)
    â”‚   â†“
    â”œâ”€â†’ è§†é¢‘ç®¡é“ (video_pipeline.py)
    â”‚   â”œâ”€â†’ äººè„¸æ£€æµ‹ (face_detection.py)
    â”‚   â”œâ”€â†’ äººè„¸è¯†åˆ« (face_recognition.py)
    â”‚   â””â”€â†’ äººè„¸æ›¿æ¢ (face_swap.py)
    â”œâ”€â†’ AIæ§åˆ¶ (ai_control/)
    â”‚   â”œâ”€â†’ è‡ªåŠ¨ç­–ç•¥ (auto_strategy.py)
    â”‚   â”œâ”€â†’ Ollamaå®¢æˆ·ç«¯ (ollama_client.py)
    â”‚   â””â”€â†’ å†…å­˜æ•°æ®åº“ (memory_db.py)
    â””â”€â†’ ARå¼•æ“ (ar_engine/)
        â”œâ”€â†’ Deep Live Cam
        â”œâ”€â†’ FaceFusion
        â””â”€â†’ iRoop DeepFaceCam
    â†“
è¾“å‡ºå±‚ (è™šæ‹Ÿæ‘„åƒå¤´/OBS)
    â†“
ç”¨æˆ·è¾“å‡º (å®æ—¶è§†é¢‘/ç›´æ’­æµ)
```

---

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **Webæ¡†æ¶**: FastAPI + Uvicorn
- **å¼‚æ­¥å¤„ç†**: asyncio + httpx
- **æ•°æ®åº“**: SQLite + å†…å­˜æ•°æ®åº“
- **ä»»åŠ¡é˜Ÿåˆ—**: å¼‚æ­¥ä»»åŠ¡è°ƒåº¦å™¨

### GUIæŠ€æœ¯
- **ç•Œé¢æ¡†æ¶**: PyQt6
- **Webæ¸²æŸ“**: QWebEngine
- **ç³»ç»Ÿé›†æˆ**: PyWin32 (Windows) / pyobjc (macOS)

### AI/MLæŠ€æœ¯
- **æœ¬åœ°æ¨¡å‹**: Ollama + LLaVA
- **äººè„¸å¤„ç†**: OpenCV + MediaPipe + dlib
- **æ·±åº¦å­¦ä¹ **: PyTorch + ONNX Runtime

### è§†é¢‘å¤„ç†
- **ç¼–è§£ç **: FFmpeg + OpenCV
- **å®æ—¶æµ**: RTMP + WebRTC
- **è™šæ‹Ÿæ‘„åƒå¤´**: DirectShow (Windows) / AVFoundation (macOS)

### ç›‘æ§è¿ç»´
- **Webå‰ç«¯**: Vue.js + ECharts
- **ç›‘æ§æŒ‡æ ‡**: psutil + GPUtil
- **æ—¥å¿—ç®¡ç†**: loguru + logrotate

---

## ğŸ“ å¼€å‘è§„èŒƒ

### Pythonä»£ç è§„èŒƒ
- éµå¾ªPEP 8é£æ ¼æŒ‡å—
- ä½¿ç”¨ç±»å‹æ³¨è§£
- å¼‚æ­¥ä¼˜å…ˆï¼ˆasync/awaitï¼‰
- å®Œæ•´çš„é”™è¯¯å¤„ç†

### Gitä½¿ç”¨è§„èŒƒ
- åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ
- æäº¤ä¿¡æ¯è§„èŒƒåŒ–
- ä»£ç å®¡æŸ¥è¦æ±‚
- è‡ªåŠ¨åŒ–æµ‹è¯•

### æ–‡æ¡£è§„èŒƒ
- ä»£ç å³æ–‡æ¡£
- APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
- READMEåŠæ—¶æ›´æ–°
- å˜æ›´æ—¥å¿—è®°å½•

---

*æœ€åæ›´æ–°: 2025-01-21 | ç‰ˆæœ¬: 2.0.0*
